<!DOCTYPE html>
<html>
<head>
<title>ASCII Intro GIF Maker</title>
<script src="https://cdn.jsdelivr.net/npm/ccapture.js@1.1.0/build/CCapture.all.min.js"></script>
</head>
<body>
<textarea id="input" rows="6" cols="50" placeholder="Put ASCII or text intro here"></textarea>
<canvas id="canvas" width="600" height="200"></canvas>
<br>
<label>Fade In:</label>
<select id="fadeIn">
<option value="typewriter">Typewriter</option>
<option value="wave">Wave</option>
<option value="glitch">Glitch</option>
<option value="flash">Flash</option>
<option value="slidein">Slide In</option>
<option value="scalein">Scale In</option>
</select>
<label>Fade Out:</label>
<select id="fadeOut">
<option value="none">None</option>
<option value="reverse">Reverse</option>
<option value="fadeout">Fade Out</option>
<option value="slideout">Slide Out</option>
<option value="scaleout">Scale Out</option>
<option value="flashout">Flash Out</option>
<option value="glitchout">Glitch Out</option>
</select>
<br>
<label>FPS:</label>
<input type="number" id="fps" value="20">
<br>
<label>Delay before Out:</label>
<input type="number" id="delayValue" value="2">
<select id="delayUnit">
<option value="s">Seconds</option>
<option value="ms">Milliseconds</option>
</select>
<br>
<button onclick="runAnim()">Generate</button>

<script>
let canvas=document.getElementById("canvas"),ctx=canvas.getContext("2d"),input=document.getElementById("input")

function render(text,scale=1,x=10,alpha=1){
 ctx.globalAlpha=1
 ctx.fillStyle="white";ctx.fillRect(0,0,canvas.width,canvas.height)
 ctx.globalAlpha=alpha
 ctx.fillStyle="black";ctx.font=`${16*scale}px monospace`
 ctx.fillText(text, x, 100)
 ctx.globalAlpha=1
}

function buildFrames(mode,text){
 let frames=[]
 if(mode=="typewriter"){for(let i=1;i<=text.length;i++)frames.push([text.slice(0,i),1,10,1])}
 if(mode=="wave"){for(let i=0;i<text.length*2;i++){frames.push([text.map((c,idx)=>idx==i%text.length?c.toUpperCase():c).join(""),1,10,1])}}
 if(mode=="glitch"){for(let i=0;i<20;i++){frames.push([text.map(c=>Math.random()<0.1?String.fromCharCode(33+Math.random()*94):c).join(""),1,10,1])}frames.push([text.join(""),1,10,1])}
 if(mode=="flash"){for(let i=0;i<20;i++){frames.push([i%2==0?text.join(""):"",1,10,1])}}
 if(mode=="slidein"){for(let x=600;x>10;x-=20)frames.push([text.join(""),1,x,1])}
 if(mode=="scalein"){for(let s=0.1;s<=1;s+=0.1)frames.push([text.join(""),s,10,1])}
 if(mode=="reverse"){let rev=[...text].reverse();for(let i=1;i<=rev.length;i++)frames.push([rev.slice(0,i).join(""),1,10,1])}
 if(mode=="fadeout"){for(let a=1;a>=0;a-=0.05)frames.push([text.join(""),1,10,a])}
 if(mode=="slideout"){for(let x=10;x<600;x+=20)frames.push([text.join(""),1,x,1])}
 if(mode=="scaleout"){for(let s=1;s>=0.1;s-=0.1)frames.push([text.join(""),s,10,1])}
 if(mode=="flashout"){for(let i=0;i<20;i++){frames.push([i%2==0?text.join(""):"",1,10,1])}}
 if(mode=="glitchout"){for(let i=0;i<20;i++){frames.push([text.map(c=>Math.random()<0.2?String.fromCharCode(33+Math.random()*94):c).join(""),1,10,1])}frames.push(["",1,10,1])}
 return frames
}

function runAnim(){
 let text=input.value.split("")
 let fadeIn=document.getElementById("fadeIn").value
 let fadeOut=document.getElementById("fadeOut").value
 let fps=parseInt(document.getElementById("fps").value)
 let delayValue=parseInt(document.getElementById("delayValue").value)
 let delayUnit=document.getElementById("delayUnit").value
 let delayFrames=(delayUnit=="s"?delayValue*fps:Math.floor(delayValue/(1000/fps)))

 let frames=[]
 frames=frames.concat(buildFrames(fadeIn,text))
 for(let d=0;d<delayFrames;d++)frames.push([text.join(""),1,10,1])
 if(fadeOut!="none")frames=frames.concat(buildFrames(fadeOut,text))

 // CCapture for GIF
 let capturer=new CCapture({format:'gif',framerate:fps,verbose:true})
 let i=0
 capturer.start()

 function draw(){
  if(i<frames.length){
   let f=frames[i];render(f[0],f[1],f[2],f[3])
   capturer.capture(canvas)
   i++;setTimeout(draw,1000/fps)
  }else{
   capturer.stop()
   capturer.save() // This will automatically download the GIF
   alert("Download should start automatically!")
  }
 }
 draw()
}
</script>
</body>
</html>